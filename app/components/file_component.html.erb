<%= render ::CompanionWindowsComponent.new(viewer:, stimulus_controller: 'file-auth tree fullscreen') do |component| %>
  <% component.with_header_button do %>
    <div class="item-count" aria-live="polite" data-tree-target="count"></div>
    <% if viewer.display_file_search? %>
      <div class='search-query-form'>
        <label for='search-input' class='visually-hidden'>Search this list</label>
        <input class='search-input' id='search-input' placeholder='Search this list' data-search-input="true" data-action="keyup->tree#search">
        <svg class="MuiSvgIcon-root" focusable="false" aria-hidden="true" viewBox="0 0 24 24"><path d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14"></path></svg>
      </div>
    <% end %>
  <% end %>

  <% component.with_header_button do %>
    <%= render CompanionWindows::ShareButtonComponent.new %>
  <% end %>

  <% component.with_header_button do %>
    <%= render CompanionWindows::FullscreenButtonComponent.new %>
  <% end %>

  <% component.with_authorization_messages do %>
    <% if viewer.purl_object.embargoed? %>
      <div role="banner" aria-label="Access message">
        <div class="authLinkWrapper">
          <svg class="MuiSvgIcon-root" focusable="false" aria-hidden="true" viewBox="0 0 24 24">
            <path d="m14.5 14.2 2.9 1.7-.8 1.3L13 15v-5h1.5zM22 14c0 4.41-3.59 8-8 8-2.02 0-3.86-.76-5.27-2H4c-1.15 0-2-.85-2-2V9c0-1.12.89-1.96 2-2v-.5C4 4.01 6.01 2 8.5 2c2.34 0 4.24 1.79 4.46 4.08.34-.05.69-.08 1.04-.08 4.41 0 8 3.59 8 8M6 7h5v-.74C10.88 4.99 9.8 4 8.5 4 7.12 4 6 5.12 6 6.5zm14 7c0-3.31-2.69-6-6-6s-6 2.69-6 6 2.69 6 6 6 6-2.69 6-6"></path>
          </svg>
          <p class="loginMessage"><%= viewer.embargo_message %></p>
        </div>
      </div>
    <% end %>
  <% end %>

  <% component.with_body do %>
    <% # background-color: white must be set for full screen when the browser prefers dark mode %>
    <div style="overflow-y: scroll; flex-basis: 100%; background-color: white;" data-fullscreen-target="area">
      <table class="sul-embed-treegrid" role="treegrid" aria-label="File list" data-action="keydown->tree#navigate" data-tree-target="table">
        <colgroup>
          <col class="sul-embed-treegrid-name">
          <col class="sul-embed-treegrid-size">
          <col class="sul-embed-treegrid-download">
        </colgroup>
        <thead>
          <tr>
            <th scope="col">File name</th>
            <th scope="col">Size</th>
            <th scope="col" class="sul-embed-text-hide visually-hidden">Download</th>
          </tr>
        </thead>
        <tbody>
          <%= render Embed::File::DirRowComponent.new(viewer: viewer, dir: viewer.purl_object.hierarchical_contents)%>
        </tbody>
      </table>
    </div>
  <% end %>
<% end %>
